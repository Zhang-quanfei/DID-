*==============================================================================*
*               Heckman两步法 | 样本选择模型 & 处理效应模型(1)                 *
*                      ——使用help文件的数据代码进行演示                        *
*==============================================================================*

**# 【说明】

*- 该版代码由微信公众号『DMETP』提供，欢迎关注

*- 可传播分享，但代码中的【说明】部分不可删除，且分享时必须注明来源

*- 来源注明参考：代码由微信公众号『DMETP』提供，版权所有

*- 版权所有，严禁商用！

********************************************************************************

*- Stata Version: 16 | 17

*- 定义路径

cd "C:\Users\KEMOSABE\Desktop\heckman"

**# 一、样本选择模型

**# 1.1 语法介绍

/*
  a. 两步估计法

      heckman y x1 x2, select(          x1 x2 z1) twostep mills(newname)

  等价于

      heckman y x1 x2, select(y_dummy = x1 x2 z1) twostep

  b. MLE

      heckman y x1 x2, select(y_dummy = x1 x2 z1) nolog

  + robust/cluster SE

      heckman y x1 x2, select(y_dummy = x1 x2 z1) nolog vce(cluster varname)
*/

**# 1.2 实例操作

webuse womenwk, clear

/*
*- 或者直接调用已下载的数据集

use womenwk.dta, clear
*/

*- 判断是否能够使用聚类标准误

tabulate county

/*
  county of |
  residence |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |        200       10.00       10.00
          1 |        200       10.00       20.00
          2 |        200       10.00       30.00
          3 |        200       10.00       40.00
          4 |        200       10.00       50.00
          5 |        200       10.00       60.00
          6 |        200       10.00       70.00
          7 |        200       10.00       80.00
          8 |        200       10.00       90.00
          9 |        200       10.00      100.00
------------+-----------------------------------
      Total |      2,000      100.00
*/

*- 查看y的缺失值情况

nmissing wage

/*
wage              657
*/

*- 生成y是否取值的虚拟变量y_dummy

gen wage_dummy = (wage != .)

*- 定义全局暂元

global xlist educ    age
global zlist married children

*-（一）基准OLS

reg wage $xlist
    est store OLS

/*
      Source |       SS           df       MS      Number of obs   =     1,343
-------------+----------------------------------   F(2, 1340)      =    227.49
       Model |  13524.0337         2  6762.01687   Prob > F        =    0.0000
    Residual |  39830.8609     1,340  29.7245231   R-squared       =    0.2535
-------------+----------------------------------   Adj R-squared   =    0.2524
       Total |  53354.8946     1,342  39.7577456   Root MSE        =     5.452

------------------------------------------------------------------------------
        wage |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
   education |   .8965829   .0498061    18.00   0.000     .7988765    .9942893
         age |   .1465739   .0187135     7.83   0.000      .109863    .1832848
       _cons |   6.084875   .8896182     6.84   0.000     4.339679    7.830071
------------------------------------------------------------------------------
*/

*-（二）MLE

heckman wage $xlist , select( wage_dummy = $xlist $zlist ) nolog mills(imr1)
    est store MLE

/*
Heckman selection model                         Number of obs     =      2,000
(regression model with sample selection)              Selected    =      1,343
                                                      Nonselected =        657

                                                Wald chi2(2)      =     508.44
Log likelihood = -5178.304                      Prob > chi2       =     0.0000

------------------------------------------------------------------------------
             |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
wage         |
   education |   .9899537   .0532565    18.59   0.000     .8855729    1.094334
         age |   .2131294   .0206031    10.34   0.000     .1727481    .2535108
       _cons |   .4857752   1.077037     0.45   0.652    -1.625179     2.59673
-------------+----------------------------------------------------------------
wage_dummy   |
   education |   .0557318   .0107349     5.19   0.000     .0346917    .0767718
         age |   .0365098   .0041533     8.79   0.000     .0283694    .0446502
     married |   .4451721   .0673954     6.61   0.000     .3130794    .5772647
    children |   .4387068   .0277828    15.79   0.000     .3842534    .4931601
       _cons |  -2.491015   .1893402   -13.16   0.000    -2.862115   -2.119915
-------------+----------------------------------------------------------------
     /athrho |   .8742086   .1014225     8.62   0.000     .6754241    1.072993
    /lnsigma |   1.792559    .027598    64.95   0.000     1.738468     1.84665
-------------+----------------------------------------------------------------
         rho |   .7035061   .0512264                      .5885365    .7905862
       sigma |   6.004797   .1657202                       5.68862    6.338548
      lambda |   4.224412   .3992265                      3.441942    5.006881
------------------------------------------------------------------------------
LR test of indep. eqns. (rho = 0):   chi2(1) =    61.20   Prob > chi2 = 0.0000
*/

*-（三）MLE + robust SE

heckman wage $xlist , select( wage_dummy = $xlist $zlist ) nolog vce(robust)
    est store MLE_r

/*
Heckman selection model                         Number of obs     =      2,000
(regression model with sample selection)              Selected    =      1,343
                                                      Nonselected =        657

                                                Wald chi2(2)      =     497.82
Log pseudolikelihood = -5178.304                Prob > chi2       =     0.0000

------------------------------------------------------------------------------
             |               Robust
             |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
wage         |
   education |   .9899537   .0534141    18.53   0.000     .8852641    1.094643
         age |   .2131294   .0211095    10.10   0.000     .1717555    .2545034
       _cons |   .4857752   1.099121     0.44   0.659    -1.668462    2.640013
-------------+----------------------------------------------------------------
wage_dummy   |
   education |   .0557318   .0108899     5.12   0.000      .034388    .0770755
         age |   .0365098   .0042243     8.64   0.000     .0282303    .0447893
     married |   .4451721   .0668243     6.66   0.000     .3141988    .5761453
    children |   .4387068   .0272779    16.08   0.000      .385243    .4921705
       _cons |  -2.491015   .1884227   -13.22   0.000    -2.860317   -2.121713
-------------+----------------------------------------------------------------
     /athrho |   .8742086   .1051331     8.32   0.000     .6681514    1.080266
    /lnsigma |   1.792559   .0288316    62.17   0.000      1.73605    1.849068
-------------+----------------------------------------------------------------
         rho |   .7035061   .0531006                      .5837626    .7932976
       sigma |   6.004797   .1731281                      5.674882    6.353893
      lambda |   4.224412   .4172197                      3.406676    5.042147
------------------------------------------------------------------------------
Wald test of indep. eqns. (rho = 0): chi2(1) =    69.14   Prob > chi2 = 0.0000
*/

*-（四）两步估计法

heckman wage $xlist , select( wage_dummy = $xlist $zlist ) twostep mills(imr2)
    est store TwoStep

/*
Heckman selection model -- two-step estimates   Number of obs     =      2,000
(regression model with sample selection)              Selected    =      1,343
                                                      Nonselected =        657

                                                Wald chi2(2)      =     442.54
                                                Prob > chi2       =     0.0000

------------------------------------------------------------------------------
             |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
wage         |
   education |   .9825259   .0538821    18.23   0.000     .8769189    1.088133
         age |   .2118695   .0220511     9.61   0.000     .1686502    .2550888
       _cons |   .7340391   1.248331     0.59   0.557    -1.712645    3.180723
-------------+----------------------------------------------------------------
wage_dummy   |
   education |   .0583645   .0109742     5.32   0.000     .0368555    .0798735
         age |   .0347211   .0042293     8.21   0.000     .0264318    .0430105
     married |   .4308575    .074208     5.81   0.000     .2854125    .5763025
    children |   .4473249   .0287417    15.56   0.000     .3909922    .5036576
       _cons |  -2.467365   .1925635   -12.81   0.000    -2.844782   -2.089948
-------------+----------------------------------------------------------------
/mills       |
      lambda |   4.001615   .6065388     6.60   0.000     2.812821     5.19041
-------------+----------------------------------------------------------------
         rho |    0.67284
       sigma |  5.9473529
------------------------------------------------------------------------------
*/

*-（五）手工两步估计法

*- 第一阶段方程（选择方程）回归

probit wage_dummy $xlist $zlist , nolog
    est store First

/*
Probit regression                               Number of obs     =      2,000
                                                LR chi2(4)        =     478.32
                                                Prob > chi2       =     0.0000
Log likelihood = -1027.0616                     Pseudo R2         =     0.1889

------------------------------------------------------------------------------
  wage_dummy |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
   education |   .0583645   .0109742     5.32   0.000     .0368555    .0798735
         age |   .0347211   .0042293     8.21   0.000     .0264318    .0430105
     married |   .4308575    .074208     5.81   0.000     .2854125    .5763025
    children |   .4473249   .0287417    15.56   0.000     .3909922    .5036576
       _cons |  -2.467365   .1925635   -12.81   0.000    -2.844782   -2.089948
------------------------------------------------------------------------------
*/

*- 计算IMR

predict y_hat, xb
gen imr = normalden(y_hat) / normal(y_hat)

*- 第二阶段方程回归

reg wage $xlist imr
    est store Second

/*
      Source |       SS           df       MS      Number of obs   =     1,343
-------------+----------------------------------   F(3, 1339)      =    173.01
       Model |  14904.6806         3  4968.22688   Prob > F        =    0.0000
    Residual |   38450.214     1,339  28.7156191   R-squared       =    0.2793
-------------+----------------------------------   Adj R-squared   =    0.2777
       Total |  53354.8946     1,342  39.7577456   Root MSE        =    5.3587

------------------------------------------------------------------------------
        wage |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
   education |   .9825259   .0504982    19.46   0.000     .8834616     1.08159
         age |   .2118695   .0206636    10.25   0.000      .171333     .252406
         imr |   4.001616   .5771027     6.93   0.000     2.869492    5.133739
       _cons |   .7340391   1.166214     0.63   0.529    -1.553766    3.021844
------------------------------------------------------------------------------
*/

*- 对比imr、imr1和imr2

order imr1 imr2 imr wage_dummy

*- 回归结果输出

local   mlist "OLS MLE MLE_r TwoStep First Second"
esttab `mlist' using 样本选择模型.rtf, replace                               ///
               b(%6.4f) t(%6.4f)                                             ///
               scalar(N r2_a r2_p) compress nogap                            ///
               star(* 0.1 ** 0.05 *** 0.01)                                  ///
               mtitle(`mlist')                                               ///
               title("Sample Selection Model")

/*
Sample Selection Model
----------------------------------------------------------------------------------------
                 (1)          (2)          (3)          (4)          (5)          (6)   
                 OLS          MLE        MLE_r      TwoStep        First       Second   
----------------------------------------------------------------------------------------
main                                                                                    
education     0.8966***    0.9900***    0.9900***    0.9825***    0.0584***    0.9825***
           (18.0015)    (18.5884)    (18.5336)    (18.2347)     (5.3184)    (19.4566)   
age           0.1466***    0.2131***    0.2131***    0.2119***    0.0347***    0.2119***
            (7.8325)    (10.3445)    (10.0964)     (9.6081)     (8.2096)    (10.2533)   
married                                                           0.4309***             
                                                                (5.8061)                
children                                                          0.4473***             
                                                               (15.5636)                
imr                                                                            4.0016***
                                                                             (6.9340)   
_cons         6.0849***    0.4858       0.4858       0.7340      -2.4674***    0.7340   
            (6.8399)     (0.4510)     (0.4420)     (0.5880)   (-12.8133)     (0.6294)   
----------------------------------------------------------------------------------------
wage_dummy                                                                              
education                  0.0557***    0.0557***    0.0584***                          
                         (5.1916)     (5.1178)     (5.3184)                             
age                        0.0365***    0.0365***    0.0347***                          
                         (8.7905)     (8.6428)     (8.2096)                             
married                    0.4452***    0.4452***    0.4309***                          
                         (6.6054)     (6.6618)     (5.8061)                             
children                   0.4387***    0.4387***    0.4473***                          
                        (15.7906)    (16.0828)    (15.5636)                             
_cons                     -2.4910***   -2.4910***   -2.4674***                          
                       (-13.1563)   (-13.2204)   (-12.8133)                             
----------------------------------------------------------------------------------------
/                                                                                       
athrho                     0.8742***    0.8742***                                       
                         (8.6195)     (8.3153)                                          
lnsigma                    1.7926***    1.7926***                                       
                        (64.9526)    (62.1733)                                          
----------------------------------------------------------------------------------------
/mills                                                                                  
lambda                                               4.0016***                          
                                                   (6.5975)                             
----------------------------------------------------------------------------------------
N               1343         2000         2000         2000         2000         1343   
r2_a          0.2524                                                           0.2777   
r2_p                                                              0.1889                
----------------------------------------------------------------------------------------
t statistics in parentheses
* p<0.1, ** p<0.05, *** p<0.01
*/

clear all
cls

**# 二、处理效应模型

**# 2.1 语法介绍

/*
  a. 两步估计法

      etregress y x1 x2, treat(D = x1 x2 z1) twostep hazard(newname)

  b. MLE

      etregress y x1 x2, treat(D = x1 x2 z1) nolog

  + robust/cluster SE

      etregress y x1 x2, treat(D = x1 x2 z1) nolog vce(cluster varname)
*/

**# 2.2 实例操作

webuse union3, clear

/*
*- 或者直接调用已下载的数据集

use union3.dta, clear
*/

*- 判断是否能够使用聚类标准误

tabulate ind_code

/*

industry of |
 employment |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |         13        0.79        0.79
          2 |          2        0.12        0.91
          3 |         12        0.73        1.64
          4 |        331       20.13       21.78
          5 |         97        5.90       27.68
          6 |        346       21.05       48.72
          7 |        158        9.61       58.33
          8 |         61        3.71       62.04
          9 |        136        8.27       70.32
         10 |         13        0.79       71.11
         11 |        374       22.75       93.86
         12 |        101        6.14      100.00
------------+-----------------------------------
      Total |      1,644      100.00
*/

*- 查看D的取值情况

tabulate union

/*
 1 if union |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |        984       79.10       79.10
          1 |        260       20.90      100.00
------------+-----------------------------------
      Total |      1,244      100.00
*/

nmissing union

/*
union             449
*/

*- 定义全局暂元

global xlist1                      black tenure
global xlist2       age grade smsa black tenure
global xlist3 union age grade smsa black tenure

*-（一）基准OLS

reg wage $xlist3
    est store OLS

/*
      Source |       SS           df       MS      Number of obs   =     1,210
-------------+----------------------------------   F(6, 1203)      =    103.36
       Model |  2163.49455         6  360.582425   Prob > F        =    0.0000
    Residual |  4196.70492     1,203  3.48853277   R-squared       =    0.3402
-------------+----------------------------------   Adj R-squared   =    0.3369
       Total |  6360.19947     1,209  5.26071089   Root MSE        =    1.8678

------------------------------------------------------------------------------
        wage |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
       union |   1.003913   .1338083     7.50   0.000     .7413894    1.266437
         age |   .1475526   .0195242     7.56   0.000     .1092474    .1858578
       grade |   .4368545   .0294718    14.82   0.000     .3790327    .4946764
        smsa |   .9754817   .1252669     7.79   0.000     .7297159    1.221248
       black |  -.6183346      .1252    -4.94   0.000    -.8639693   -.3726999
      tenure |   .2118016   .0338481     6.26   0.000     .1453938    .2782094
       _cons |  -4.326028   .5315474    -8.14   0.000    -5.368891   -3.283165
------------------------------------------------------------------------------
*/

*-（二）MLE

etregress wage $xlist2 , treat(union = $xlist1 south) nolog hazard(imr1)
    est store MLE

/*
Linear regression with endogenous treatment     Number of obs     =      1,210
Estimator: maximum likelihood                   Wald chi2(6)      =     681.89
Log likelihood =  -3051.575                     Prob > chi2       =     0.0000

------------------------------------------------------------------------------
             |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
wage         |
         age |   .1487409   .0193291     7.70   0.000     .1108566    .1866252
       grade |   .4205658   .0293577    14.33   0.000     .3630258    .4781058
        smsa |   .9117044   .1249041     7.30   0.000     .6668969    1.156512
       black |  -.7882471   .1367078    -5.77   0.000     -1.05619   -.5203048
      tenure |   .1524015   .0369596     4.12   0.000     .0799621    .2248409
     1.union |   2.945815   .2749621    10.71   0.000       2.4069    3.484731
       _cons |  -4.351572   .5283952    -8.24   0.000    -5.387208   -3.315936
-------------+----------------------------------------------------------------
union        |
       black |   .4557499   .0958042     4.76   0.000     .2679771    .6435226
      tenure |   .0871536   .0232483     3.75   0.000     .0415878    .1327195
       south |  -.5807419   .0851111    -6.82   0.000    -.7475566   -.4139271
       _cons |  -.8855758   .0724506   -12.22   0.000    -1.027576   -.7435753
-------------+----------------------------------------------------------------
     /athrho |  -.6544347   .0910314    -7.19   0.000     -.832853   -.4760164
    /lnsigma |   .7026769   .0293372    23.95   0.000      .645177    .7601767
-------------+----------------------------------------------------------------
         rho |  -.5746478    .060971                      -.682005   -.4430476
       sigma |   2.019151   .0592362                      1.906325    2.138654
      lambda |    -1.1603   .1495097                     -1.453334   -.8672668
------------------------------------------------------------------------------
LR test of indep. eqns. (rho = 0):   chi2(1) =    19.84   Prob > chi2 = 0.0000
*/

*-（三）MLE + robust SE

etregress wage $xlist2 , treat(union = $xlist1 south) nolog vce(robust)
    est store MLE_r

/*
Linear regression with endogenous treatment     Number of obs     =      1,210
Estimator: maximum likelihood                   Wald chi2(6)      =     487.30
Log pseudolikelihood =  -3051.575               Prob > chi2       =     0.0000

------------------------------------------------------------------------------
             |               Robust
             |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
wage         |
         age |   .1487409   .0206909     7.19   0.000     .1081875    .1892943
       grade |   .4205658   .0377922    11.13   0.000     .3464945    .4946371
        smsa |   .9117044   .1199377     7.60   0.000     .6766308    1.146778
       black |  -.7882471   .1408988    -5.59   0.000    -1.064404   -.5120906
      tenure |   .1524015   .0473782     3.22   0.001     .0595419    .2452611
     1.union |   2.945815   .5643841     5.22   0.000     1.839643    4.051988
       _cons |  -4.351572   .6371071    -6.83   0.000    -5.600279   -3.102865
-------------+----------------------------------------------------------------
union        |
       black |   .4557499    .093489     4.87   0.000     .2725148    .6389849
      tenure |   .0871536   .0251543     3.46   0.001     .0378521    .1364552
       south |  -.5807419   .0837513    -6.93   0.000    -.7448914   -.4165924
       _cons |  -.8855758   .0739533   -11.97   0.000    -1.030522   -.7406301
-------------+----------------------------------------------------------------
     /athrho |  -.6544347   .2322442    -2.82   0.005    -1.109625   -.1992445
    /lnsigma |   .7026769   .0758152     9.27   0.000     .5540819    .8512719
-------------+----------------------------------------------------------------
         rho |  -.5746478   .1555525                     -.8039298   -.1966492
       sigma |   2.019151   .1530822                      1.740342    2.342624
      lambda |    -1.1603   .3823277                     -1.909649   -.4109519
------------------------------------------------------------------------------
Wald test of indep. eqns. (rho = 0): chi2(1) =     7.94   Prob > chi2 = 0.0048
*/

*-（四）两步估计法

etregress wage $xlist2 , treat(union = $xlist1 south) twostep hazard(imr2)
    est store TwoStep

/*
Linear regression with endogenous treatment     Number of obs      =      1210
Estimator: two-step                             Wald chi2(8)       =    566.56
                                                Prob > chi2        =    0.0000

------------------------------------------------------------------------------
             |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
wage         |
         age |   .1543231   .0194903     7.92   0.000     .1161227    .1925234
       grade |   .4225025    .029014    14.56   0.000     .3656362    .4793689
        smsa |   .8628628   .1285907     6.71   0.000     .6108297    1.114896
       black |  -.9206944   .1774617    -5.19   0.000    -1.268513    -.572876
      tenure |   .1003226    .051879     1.93   0.053    -.0013584    .2020037
       union |   4.563859   1.006459     4.53   0.000     2.591236    6.536483
       _cons |  -4.670352   .5401517    -8.65   0.000     -5.72903   -3.611674
-------------+----------------------------------------------------------------
union        |
       black |   .4397974   .0972261     4.52   0.000     .2492377    .6303572
      tenure |   .0997638   .0236575     4.22   0.000      .053396    .1461317
       south |  -.4895032   .0933276    -5.24   0.000    -.6724221   -.3065844
       _cons |  -.9679795   .0746464   -12.97   0.000    -1.114284   -.8216753
-------------+----------------------------------------------------------------
hazard       |
      lambda |  -2.093313   .5801968    -3.61   0.000    -3.230478   -.9561486
-------------+----------------------------------------------------------------
         rho |   -0.89172
       sigma |  2.3475104
------------------------------------------------------------------------------
*/

*-（五）手工两步估计法

*- 第一阶段方程（选择方程）回归

probit union $xlist1 south, nolog
    est store First

/*
Probit regression                               Number of obs     =      1,210
                                                LR chi2(3)        =      56.54
                                                Prob > chi2       =     0.0000
Log likelihood = -592.15536                     Pseudo R2         =     0.0456

------------------------------------------------------------------------------
       union |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
       black |   .4397974   .0972261     4.52   0.000     .2492377    .6303572
      tenure |   .0997638   .0236575     4.22   0.000      .053396    .1461317
       south |  -.4895032   .0933276    -5.24   0.000    -.6724221   -.3065844
       _cons |  -.9679795   .0746464   -12.97   0.000    -1.114284   -.8216753
------------------------------------------------------------------------------
*/

*- 计算IMR

predict y_hat, xb
gen     imr =  normalden(y_hat) / normal( y_hat) if union != .
replace imr = -normalden(y_hat) / normal(-y_hat) if union == 0

*- 第二阶段方程回归

reg wage $xlist3 imr
    est store Second

/*
      Source |       SS           df       MS      Number of obs   =     1,210
-------------+----------------------------------   F(7, 1202)      =     92.54
       Model |  2227.31385         7  318.187693   Prob > F        =    0.0000
    Residual |  4132.88562     1,202  3.43834078   R-squared       =    0.3502
-------------+----------------------------------   Adj R-squared   =    0.3464
       Total |  6360.19947     1,209  5.26071089   Root MSE        =    1.8543

------------------------------------------------------------------------------
        wage |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
       union |    4.56386    .836918     5.45   0.000     2.921877    6.205842
         age |   .1543231   .0194468     7.94   0.000     .1161696    .1924765
       grade |   .4225025    .029448    14.35   0.000     .3647272    .4802778
        smsa |   .8628628     .12708     6.79   0.000     .6135395    1.112186
       black |  -.9206944   .1427409    -6.45   0.000    -1.200743   -.6406455
      tenure |   .1003226   .0424118     2.37   0.018     .0171133    .1835319
         imr |  -2.093314   .4858841    -4.31   0.000    -3.046589   -1.140038
       _cons |  -4.670352   .5337275    -8.75   0.000    -5.717493   -3.623211
------------------------------------------------------------------------------
*/

*- 对比imr、imr1和imr2

order imr1 imr2 imr union

*- 回归结果输出

local   mlist "OLS MLE MLE_r TwoStep First Second"
esttab `mlist' using 处理效应模型.rtf, replace                               ///
               b(%6.4f) t(%6.4f)                                             ///
               scalar(N r2_a r2_p) compress nogap                            ///
               star(* 0.1 ** 0.05 *** 0.01)                                  ///
               mtitle(`mlist')                                               ///
               title("Treatment Effects Model")

/*
Treatment Effects Model
----------------------------------------------------------------------------------------
                 (1)          (2)          (3)          (4)          (5)          (6)   
                 OLS          MLE        MLE_r      TwoStep        First       Second   
----------------------------------------------------------------------------------------
main                                                                                    
union         1.0039***                              4.5639***                 4.5639***
            (7.5026)                               (4.5346)                  (5.4532)   
age           0.1476***    0.1487***    0.1487***    0.1543***                 0.1543***
            (7.5574)     (7.6952)     (7.1887)     (7.9179)                  (7.9357)   
grade         0.4369***    0.4206***    0.4206***    0.4225***                 0.4225***
           (14.8228)    (14.3256)    (11.1284)    (14.5620)                 (14.3474)   
smsa          0.9755***    0.9117***    0.9117***    0.8629***                 0.8629***
            (7.7872)     (7.2992)     (7.6015)     (6.7102)                  (6.7899)   
black        -0.6183***   -0.7882***   -0.7882***   -0.9207***    0.4398***   -0.9207***
           (-4.9388)    (-5.7659)    (-5.5944)    (-5.1881)     (4.5234)    (-6.4501)   
tenure        0.2118***    0.1524***    0.1524***    0.1003*      0.0998***    0.1003** 
            (6.2574)     (4.1235)     (3.2167)     (1.9338)     (4.2170)     (2.3654)   
1.union                    2.9458***    2.9458***                                       
                        (10.7135)     (5.2195)                                          
south                                                            -0.4895***             
                                                               (-5.2450)                
imr                                                                           -2.0933***
                                                                            (-4.3083)   
_cons        -4.3260***   -4.3516***   -4.3516***   -4.6704***   -0.9680***   -4.6704***
           (-8.1386)    (-8.2354)    (-6.8302)    (-8.6464)   (-12.9675)    (-8.7504)   
----------------------------------------------------------------------------------------
union                                                                                   
black                      0.4557***    0.4557***    0.4398***                          
                         (4.7571)     (4.8749)     (4.5234)                             
tenure                     0.0872***    0.0872***    0.0998***                          
                         (3.7488)     (3.4648)     (4.2170)                             
south                     -0.5807***   -0.5807***   -0.4895***                          
                        (-6.8233)    (-6.9341)    (-5.2450)                             
_cons                     -0.8856***   -0.8856***   -0.9680***                          
                       (-12.2232)   (-11.9748)   (-12.9675)                             
----------------------------------------------------------------------------------------
/                                                                                       
athrho                    -0.6544***   -0.6544***                                       
                        (-7.1891)    (-2.8179)                                          
lnsigma                    0.7027***    0.7027***                                       
                        (23.9517)     (9.2683)                                          
----------------------------------------------------------------------------------------
hazard                                                                                  
lambda                                              -2.0933***                          
                                                  (-3.6079)                             
----------------------------------------------------------------------------------------
N               1210         1210         1210         1210         1210         1210   
r2_a          0.3369                                                           0.3464   
r2_p                                                              0.0456                
----------------------------------------------------------------------------------------
t statistics in parentheses
* p<0.1, ** p<0.05, *** p<0.01
*/